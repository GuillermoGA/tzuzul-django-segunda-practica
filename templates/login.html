{% extends 'base.html' %}

{% block content %}
<div class="col">
    <h2>Login</h2>
    <form id="login_form">
        <div class="form-group">
            <label for="username">Username</label>
            <input type="text" name="username" id="username" class="form-control">
        </div>

        <div class="form-group">
            <label for="password">Password</label>
            <input type="password" name="password" id="password" class="form-control">
        </div>

        <button type="button" class="btn btn-primary" onclick="login()">Login</button>
    </form>


    <script>
        function login(){
            var form_data = Array.from(document.querySelectorAll('#login_form input')).reduce((acc, input) => ({ ...acc, [input.id]: input.value}),{});

            fetch("{% url 'api_login' %}", {
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({
                    "username": form_data["username"],
                    "password": form_data["password"]
                }),
                method: "POST"
            })
            .then(response=>response.json())
            .then(result=>console.log(result))
        };
    </script>
</div>
{% endblock %}